<link rel="stylesheet" href="/frontend/mylist.css">
<link rel="stylesheet" href="/frontend/news.css">

<section style="--background-color: #0C1018; --border-color: #473590; --angle: 110deg" class="news-container fancy-card" id="youtube-vue">
    <article class="text-white">
        <div class="pb-4 news-section-header">
            <h1 class="text-white pb-1 news-section-title">Youtube Playlist upload for FLIX APP</h1>
            <h2 class="news-section-subtitle">Upload Your Playlist</h2>
        </div>

        <form method="post" class="col-md-7 m-auto" action="/saveYoutubeLists">
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label>Mac Address</label>
                        <input
                                type="text"
                                class="form-control mac-address"
                                placeholder="00:aa:bb:cc:dd:11"
                                name="mac_address"
                                maxlength="17"
                                required
                        >
                    </div>
                </div>

                <div class="col-md-6">
                    <div v-for="(item,index) in urls" class="w-full">
                        <div class="form-group mb-0">
                            <label>Name</label>
                            <div class="d-flex url-input-container">
                                <div>
                                    <input
                                            type="text"
                                            class="form-control w-full"
                                            name="names[]"
                                            v-model="item.name"
                                            required
                                    >
                                </div>
                                <button class="btn text-white d-flex align-items-center justify-content-center btn-delete"
                                        v-if="urls.length>1"
                                        @click="deleteUrl(index)">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                         xmlns="http://www.w3.org/2000/svg">
                                        <path d="M20.9999 6.73001C20.9799 6.73001 20.9499 6.73001 20.9199 6.73001C15.6299 6.20001 10.3499 6.00001 5.11992 6.53001L3.07992 6.73001C2.65992 6.77001 2.28992 6.47001 2.24992 6.05001C2.20992 5.63001 2.50992 5.27001 2.91992 5.23001L4.95992 5.03001C10.2799 4.49001 15.6699 4.70001 21.0699 5.23001C21.4799 5.27001 21.7799 5.64001 21.7399 6.05001C21.7099 6.44001 21.3799 6.73001 20.9999 6.73001Z"
                                              fill="white"/>
                                        <path d="M8.50001 5.72C8.46001 5.72 8.42001 5.72 8.37001 5.71C7.97001 5.64 7.69001 5.25 7.76001 4.85L7.98001 3.54C8.14001 2.58 8.36001 1.25 10.69 1.25H13.31C15.65 1.25 15.87 2.63 16.02 3.55L16.24 4.85C16.31 5.26 16.03 5.65 15.63 5.71C15.22 5.78 14.83 5.5 14.77 5.1L14.55 3.8C14.41 2.93 14.38 2.76 13.32 2.76H10.7C9.64001 2.76 9.62001 2.9 9.47001 3.79L9.24001 5.09C9.18001 5.46 8.86001 5.72 8.50001 5.72Z"
                                              fill="white"/>
                                        <path d="M15.2099 22.75H8.7899C5.2999 22.75 5.1599 20.82 5.0499 19.26L4.3999 9.19001C4.3699 8.78001 4.6899 8.42001 5.0999 8.39001C5.5199 8.37001 5.8699 8.68001 5.8999 9.09001L6.5499 19.16C6.6599 20.68 6.6999 21.25 8.7899 21.25H15.2099C17.3099 21.25 17.3499 20.68 17.4499 19.16L18.0999 9.09001C18.1299 8.68001 18.4899 8.37001 18.8999 8.39001C19.3099 8.42001 19.6299 8.77001 19.5999 9.19001L18.9499 19.26C18.8399 20.82 18.6999 22.75 15.2099 22.75Z"
                                              fill="white"/>
                                        <path d="M13.6601 17.25H10.3301C9.92008 17.25 9.58008 16.91 9.58008 16.5C9.58008 16.09 9.92008 15.75 10.3301 15.75H13.6601C14.0701 15.75 14.4101 16.09 14.4101 16.5C14.4101 16.91 14.0701 17.25 13.6601 17.25Z"
                                              fill="white"/>
                                        <path d="M14.5 13.25H9.5C9.09 13.25 8.75 12.91 8.75 12.5C8.75 12.09 9.09 11.75 9.5 11.75H14.5C14.91 11.75 15.25 12.09 15.25 12.5C15.25 12.91 14.91 13.25 14.5 13.25Z"
                                              fill="white"/>
                                    </svg>
                                </button>
                                <button class="btn text-white d-flex align-items-center justify-content-center btn-add"
                                        @click="addUrl()">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                         xmlns="http://www.w3.org/2000/svg">
                                        <path d="M18 12.75H6C5.59 12.75 5.25 12.41 5.25 12C5.25 11.59 5.59 11.25 6 11.25H18C18.41 11.25 18.75 11.59 18.75 12C18.75 12.41 18.41 12.75 18 12.75Z"
                                              fill="white"/>
                                        <path d="M12 18.75C11.59 18.75 11.25 18.41 11.25 18V6C11.25 5.59 11.59 5.25 12 5.25C12.41 5.25 12.75 5.59 12.75 6V18C12.75 18.41 12.41 18.75 12 18.75Z"
                                              fill="white"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Playlist ID</label>
                            <div class="url-input-container">
                                <div>
                                    <input
                                            type="text"
                                            class="form-control"
                                            name="playlist_ids[]"
                                            v-model="item.playlist_id"
                                            required
                                    >
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-12">
                    <input type="hidden" name="recaptcha_token" class="recaptcha_token">

                    <div class="text-center m-auto">
                        <button class="btn btn-primary btn-submit" id="send-url-btn">Send</button>
                    </div>
                </div>
            </div>
        </form>
    </article>
</section>

<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://www.google.com/recaptcha/api.js?render=<%=recaptcha_site_key%>"></script>
<script>
    var recaptcha_token=null;

    var app=new Vue({
        el:"#youtube-vue",
        data:{
            urls:[
                {
                    name:"",
                    playlist_id:""
                }
            ]
        },
        methods:{
            addUrl(){
                this.urls.push(
                    {
                        name:"",
                        playlist_id:""
                    }
                )
            },
            deleteUrl(index){
                this.urls.splice(index,1);
            }
        }
    });
    $('form').submit(function (e){
        var that=this;
        if(!recaptcha_token){
            e.preventDefault();
            var recaptcha_site_key='<%=recaptcha_site_key%>'
            grecaptcha.execute(recaptcha_site_key, {action:'verify'})
                .then(function(token) {
                    $('.recaptcha_token').val(token);
                    console.log(token);
                    recaptcha_token=token;
                    that.submit();
                });
        }else
            return true;
    });


</script>
